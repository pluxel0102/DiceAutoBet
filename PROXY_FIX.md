# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ–∫—Å–∏ –¥–ª—è OpenRouter

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
```
SOCKS: Connection not allowed by ruleset
```

–ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ OpenRouter API.

---

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Fallback**
–¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç OpenRouter, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**:

```kotlin
// –ü—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
client.newCall(request).execute()

// ‚ùå –ï—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç SOCKS
if (e.message?.contains("SOCKS") == true) {
    // ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—É–µ–º –Ω–∞–ø—Ä—è–º—É—é
    sendApiRequestDirect(requestBody)
}
```

### 2. **–ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ OpenRouter**
–î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `sendApiRequestDirect()` –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç OkHttpClient **–ë–ï–ó –ø—Ä–æ–∫—Å–∏**:

```kotlin
val directClient = OkHttpClient.Builder()
    .connectTimeout(30, TimeUnit.SECONDS)
    .readTimeout(60, TimeUnit.SECONDS)
    .writeTimeout(60, TimeUnit.SECONDS)
    .build() // –ë–ï–ó Proxy
```

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ–ø–µ—Ä—å

### –ê–ª–≥–æ—Ä–∏—Ç–º:
```
1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–∫–ª—é—á–µ–Ω –ª–∏ –ø—Ä–æ–∫—Å–∏
   ‚îú‚îÄ‚îÄ ‚úÖ –í–∫–ª—é—á–µ–Ω ‚Üí –ø—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
   ‚îî‚îÄ‚îÄ ‚ùå –û—Ç–∫–ª—é—á–µ–Ω ‚Üí —Å—Ä–∞–∑—É –Ω–∞–ø—Ä—è–º—É—é

2. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥

3. –ï—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç (SOCKS error):
   ‚îî‚îÄ‚îÄ üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

4. –ï—Å–ª–∏ –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
   ‚îî‚îÄ‚îÄ ‚úÖ –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç OpenRouter
```

---

## üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ù–∏—á–µ–≥–æ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback)
–ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ - –æ–Ω–æ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –±—É–¥–µ—Ç –ø—Ä–æ–±–æ–≤–∞—Ç—å –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–∫—Å–∏ –≤—Ä—É—á–Ω—É—é
–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è OpenRouter:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `ProxyManager.kt`
2. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:
   ```kotlin
   private var _isProxyEnabled = true
   ```
3. –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞:
   ```kotlin
   private var _isProxyEnabled = false
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≤ UI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏ –¥–ª—è AI" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## üìä –õ–æ–≥–∏

### –¢–µ–ø–µ—Ä—å –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
üîó –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ OpenRouter API —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
‚ùå –û—à–∏–±–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–∞ (–ø—Ä–æ–∫—Å–∏): SOCKS: Connection not allowed by ruleset
‚ö†Ô∏è –ü—Ä–æ–∫—Å–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç OpenRouter! –ü—Ä–æ–±—É–µ–º –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...
üåç –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ OpenRouter –Ω–∞–ø—Ä—è–º—É—é (–±–µ–∑ –ø—Ä–æ–∫—Å–∏)...
‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ!
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

### –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫—É–±–∏–∫–∏ —á–µ—Ä–µ–∑ OpenRouter
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   - ‚ö†Ô∏è –ü—Ä–æ–∫—Å–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç OpenRouter
   - üåç –ü—Ä–æ–±—É–µ–º –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
   - ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback** –Ω–∞ –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ **–ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫** - —Ä–∞–±–æ—Ç–∞–µ—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"
- ‚úÖ **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–∫—Å–∏** –¥–ª—è –¥—Ä—É–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–∏–≥—Ä–∞, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã)

**–¢–µ–ø–µ—Ä—å OpenRouter –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –µ–≥–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç!** üöÄ

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 20 –æ–∫—Ç—è–±—Ä—è 2025 –≥.  
**–§–∞–π–ª:** `OpenRouterDiceRecognizer.kt`  
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:** –î–æ–±–∞–≤–ª–µ–Ω `sendApiRequestDirect()` –º–µ—Ç–æ–¥ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
