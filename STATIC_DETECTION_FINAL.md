# üéØ –î–µ—Ç–µ–∫—Ü–∏—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –Ω–∞–¥–ø–∏—Å–µ–π - –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –£–º–Ω–∞—è –¥–≤—É—Ö—Ä–µ–∂–∏–º–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è:

#### üì± **–î–≤–æ–π–Ω–æ–π —Ä–µ–∂–∏–º** (SimpleDualModeController)
- –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è: `crop` (–≤—ã—Ä–µ–∑–∞–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∫—É–±–∏–∫–æ–≤ ~800x400)
- **–î–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞:** ‚úÖ –í–∫–ª—é—á–µ–Ω–∞
- **–î–µ—Ç–µ–∫—Ü–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è:** ‚úÖ –í–∫–ª—é—á–µ–Ω–∞

```kotlin
// –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞–ª–µ–Ω—å–∫–æ–µ (<1000x1000)
// ‚Üí checkTextOverlay = true
// ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ —Ç–µ–∫—Å—Ç, –∏ –∑–∞–≤–∏—Å–∞–Ω–∏–µ
```

#### üì± **–û–¥–∏–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º** (SingleModeController)
- –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è: `fullScreenshot` (–ø–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω >1080x1920)
- **–î–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞:** ‚ùå –û—Ç–∫–ª—é—á–µ–Ω–∞
- **–î–µ—Ç–µ–∫—Ü–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è:** ‚úÖ –í–∫–ª—é—á–µ–Ω–∞

```kotlin
// –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–ª—å—à–æ–µ (>1000x1000)
// ‚Üí checkTextOverlay = false
// ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ–º –¢–û–õ–¨–ö–û –∑–∞–≤–∏—Å–∞–Ω–∏–µ
```

---

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. `StaticFrameDetector.kt`

**–ú–µ—Ç–æ–¥ `shouldSkipFrame()` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º:**

```kotlin
fun shouldSkipFrame(
    bitmap: Bitmap, 
    checkTextOverlay: Boolean = true  // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–æ–≤–µ—Ä—è–µ–º
): Boolean {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–∞ - —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ
    if (checkTextOverlay && isLikelyTextOverlay(bitmap)) {
        return true
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∞–Ω–∏—è - –≤—Å–µ–≥–¥–∞
    if (isStuckOnStaticImage(getImageHash(bitmap))) {
        return true
    }
    
    return false
}
```

### 2. `HybridDiceRecognizer.kt`

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**

```kotlin
suspend fun analyzeDice(bitmap: Bitmap): DotCounter.Result? {
    return withContext(Dispatchers.Default) {
        // üîç –û–ø—Ä–µ–¥–µ–ª—è–µ–º: crop –∏–ª–∏ full screen?
        val isCroppedArea = bitmap.width < 1000 && bitmap.height < 1000
        
        // üõ°Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å —É—á–µ—Ç–æ–º —Ç–∏–ø–∞
        if (StaticFrameDetector.shouldSkipFrame(bitmap, isCroppedArea)) {
            Log.d(TAG, "‚è≠Ô∏è –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–∞–¥—Ä")
            return@withContext null
        }
        
        // ... –∞–Ω–∞–ª–∏–∑
    }
}
```

---

## üìä –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –î–≤–æ–π–Ω–æ–π —Ä–µ–∂–∏–º (crop):

```
–ö–∞–¥—Ä 803x379 (crop)
  ‚Üì
isCroppedArea = true
  ‚Üì
checkTextOverlay = true
  ‚Üì
StaticFrameDetector:
  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —è—Ä–∫–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ ‚úÖ
  ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∞–Ω–∏—è ‚úÖ
```

### –û–¥–∏–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º (full):

```
–ö–∞–¥—Ä 1080x1920 (full)
  ‚Üì
isCroppedArea = false
  ‚Üì
checkTextOverlay = false
  ‚Üì
StaticFrameDetector:
  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —è—Ä–∫–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ ‚ùå (–ø—Ä–æ–ø—É—â–µ–Ω–∞)
  ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∞–Ω–∏—è ‚úÖ
```

---

## üéÆ –ü—Ä–∏–º–µ—Ä—ã

### –î–≤–æ–π–Ω–æ–π —Ä–µ–∂–∏–º: "–û–ñ–ò–î–ê–ù–ò–ï –ü–ê–†–¢–ò–ò"
```log
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: 803x379
‚Üí –í—ã—Ä–µ–∑–∞–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å
‚Üí checkTextOverlay = true
‚Üí –Ø—Ä–∫–æ—Å—Ç—å 85% > 60%
‚Üí ‚è≠Ô∏è –ü–†–û–ü–£–°–ö (—Ç–µ–∫—Å—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω)
```

### –û–¥–∏–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º: "–û–ñ–ò–î–ê–ù–ò–ï –ü–ê–†–¢–ò–ò"
```log
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: 1080x1920
‚Üí –ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω
‚Üí checkTextOverlay = false
‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–∞ –ü–†–û–ü–£–©–ï–ù–ê
‚Üí ‚úÖ –ê–ù–ê–õ–ò–ó (AI —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –≤–µ—Å—å —ç–∫—Ä–∞–Ω)
```

### –õ—é–±–æ–π —Ä–µ–∂–∏–º: –ó–∞–≤–∏—Å–∞–Ω–∏–µ >3 —Å–µ–∫
```log
MD5 —Ö—ç—à –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è 3050–º—Å
‚Üí ‚è≠Ô∏è –ü–†–û–ü–£–°–ö (–∑–∞–≤–∏—Å–∞–Ω–∏–µ)
```

---

## ‚öôÔ∏è –ü–æ—á–µ–º—É —Ç–∞–∫?

### –î–≤–æ–π–Ω–æ–π —Ä–µ–∂–∏–º (crop):
- ‚úÖ –û–±–ª–∞—Å—Ç—å **—Ç–æ—á–Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç** –∫—É–±–∏–∫–∏
- ‚úÖ "–û–ñ–ò–î–ê–ù–ò–ï –ü–ê–†–¢–ò–ò" –ø–æ—è–≤–ª—è–µ—Ç—Å—è **–≤ —Ü–µ–Ω—Ç—Ä–µ** —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏
- ‚úÖ –î–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç **–∏–¥–µ–∞–ª—å–Ω–æ**

### –û–¥–∏–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º (full):
- ‚ùå –°–∫—Ä–∏–Ω—à–æ—Ç **–≤—Å–µ–≥–æ —ç–∫—Ä–∞–Ω–∞** (–∫—É–±–∏–∫–∏ –≥–¥–µ-—Ç–æ –≤ –æ–±–ª–∞—Å—Ç–∏)
- ‚ùå "–û–ñ–ò–î–ê–ù–ò–ï –ü–ê–†–¢–ò–ò" **–Ω–µ –≤ —Ü–µ–Ω—Ç—Ä–µ** —ç–∫—Ä–∞–Ω–∞
- ‚ùå –î–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É —ç–∫—Ä–∞–Ω–∞ **–Ω–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞**
- ‚úÖ AI –≤–∏–¥–∏—Ç **–≤–µ—Å—å —ç–∫—Ä–∞–Ω** –∏ —Å–∞–º –ø–æ–Ω–∏–º–∞–µ—Ç –≥–¥–µ –∫—É–±–∏–∫–∏
- ‚úÖ –î–µ—Ç–µ–∫—Ü–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è **—Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ**

---

## üì¶ –§–∞–π–ª—ã

### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω:
- **`StaticFrameDetector.kt`**
  - –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `checkTextOverlay: Boolean = true`
  
- **`HybridDiceRecognizer.kt`**
  - –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä—É
  - –£—Å–ª–æ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–∞

### ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **`SUMMARY_STATIC_DETECTION.md`** - –æ–±–Ω–æ–≤–ª–µ–Ω
- **`STATIC_DETECTION_FINAL.md`** - —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

## ‚úÖ –ò—Ç–æ–≥

| –†–µ–∂–∏–º | –†–∞–∑–º–µ—Ä | –î–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ | –î–µ—Ç–µ–∫—Ü–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è |
|-------|--------|-----------------|-------------------|
| **–î–≤–æ–π–Ω–æ–π** | ~800x400 | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| **–û–¥–∏–Ω–æ—á–Ω—ã–π** | >1080x1920 | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –î–≤–æ–π–Ω–æ–π —Ä–µ–∂–∏–º: –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç "–û–ñ–ò–î–ê–ù–ò–ï –ü–ê–†–¢–ò–ò" + –∑–∞–≤–∏—Å–∞–Ω–∏—è
- ‚úÖ –û–¥–∏–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º: –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–≤–∏—Å–∞–Ω–∏—è
- ‚úÖ –ù–µ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è API –∫–≤–æ—Ç—ã

---

**–î–∞—Ç–∞:** 20 –æ–∫—Ç—è–±—Ä—è 2025 –≥.  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ  
**–ö–æ–º–ø–∏–ª—è—Ü–∏—è:** ‚úÖ –ë–µ–∑ –æ—à–∏–±–æ–∫
